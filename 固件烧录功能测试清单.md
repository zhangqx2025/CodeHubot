# 固件烧录功能 - 测试清单

## 📋 功能测试清单

### 1. 环境准备 ✅

- [ ] Node.js 已安装（16.x+）
- [ ] 使用 Chrome 或 Edge 浏览器（89+）
- [ ] ESP32 设备准备就绪
- [ ] USB 数据线（非充电线）

### 2. 安装测试

```bash
cd frontend
npm install
```

**验证点：**
- [ ] 依赖安装成功
- [ ] `esptool-js` 包已安装
- [ ] 无错误提示

### 3. 启动测试

```bash
npm run dev
```

**验证点：**
- [ ] 服务成功启动在 http://localhost:3000
- [ ] 无编译错误
- [ ] 浏览器控制台无错误

### 4. 页面访问测试

**方式 1：直接访问**
- [ ] 访问 `http://localhost:3000/device/firmware-flasher`
- [ ] 页面正常加载
- [ ] UI 显示正常

**方式 2：通过菜单访问**
- [ ] 登录系统
- [ ] 进入"设备管理"
- [ ] 左侧菜单显示"固件烧录"选项
- [ ] 点击菜单项，页面正常跳转

### 5. UI 组件测试

#### 5.1 页面布局
- [ ] 页面标题显示正确："ESP32 固件烧录工具"
- [ ] 警告提示框显示
- [ ] 所有卡片和面板正常显示

#### 5.2 状态卡片
- [ ] 初始状态显示"未连接设备"
- [ ] 状态指示灯为红色
- [ ] 连接后显示芯片信息
- [ ] 连接后状态指示灯变为绿色

#### 5.3 连接按钮
- [ ] "连接设备"按钮可点击
- [ ] "断开连接"按钮初始禁用
- [ ] 连接后"连接设备"按钮禁用
- [ ] 连接后"断开连接"按钮可用

#### 5.4 固件选择
- [ ] 下拉框显示固件列表
- [ ] 选择固件后显示详细信息
- [ ] 固件信息包含：名称、版本、日期、大小、描述

#### 5.5 操作按钮
- [ ] "开始烧录"按钮（未连接时禁用）
- [ ] "擦除Flash"按钮（未连接时禁用）
- [ ] "重启设备"按钮（未连接时禁用）
- [ ] 连接后按钮状态正确更新

#### 5.6 日志面板
- [ ] 日志容器正常显示
- [ ] 初始日志提示正确
- [ ] "清空日志"按钮可用

#### 5.7 使用提示
- [ ] 5 条使用提示全部显示
- [ ] 图标和文字正确对齐

### 6. 功能测试

#### 6.1 浏览器兼容性检测
- [ ] 在 Chrome 中打开，显示"准备就绪"
- [ ] 在 Firefox 中打开，显示不支持提示（如果测试）

#### 6.2 设备连接功能

**测试步骤：**
1. 连接 ESP32 设备到电脑
2. 点击"连接设备"按钮
3. 在弹出的串口选择对话框中选择设备

**验证点：**
- [ ] 串口选择对话框正常弹出
- [ ] 可以看到设备串口（如 COM3、/dev/ttyUSB0）
- [ ] 选择后开始连接
- [ ] 日志显示"正在请求串口访问权限..."
- [ ] 连接成功后显示芯片型号（如 ESP32-S3）
- [ ] 状态卡片更新为"已连接"
- [ ] 成功提示消息显示

#### 6.3 固件选择功能

**测试步骤：**
1. 点击固件选择下拉框
2. 选择"ESP32-S3-Lite v1.6"

**验证点：**
- [ ] 下拉框显示固件列表
- [ ] 选择后显示固件详细信息
- [ ] 日志记录"已选择固件"

#### 6.4 固件烧录功能

**测试步骤：**
1. 确保设备已连接
2. 选择固件版本
3. 点击"开始烧录"按钮
4. 等待烧录完成

**验证点：**
- [ ] 烧录开始，按钮变为"烧录中..."
- [ ] 进度条出现并更新
- [ ] 日志显示烧录进度（0%、10%、20%...100%）
- [ ] 烧录过程约 2-3 分钟
- [ ] 烧录完成显示"固件烧录完成"
- [ ] 成功提示消息显示
- [ ] 设备自动重启（或提示手动重启）
- [ ] 进度条消失

#### 6.5 擦除 Flash 功能

**测试步骤：**
1. 确保设备已连接
2. 点击"擦除Flash"按钮
3. 确认警告对话框

**验证点：**
- [ ] 警告对话框弹出
- [ ] 对话框提示"此操作不可恢复"
- [ ] 点击"取消"，操作中止
- [ ] 点击"确定擦除"，开始擦除
- [ ] 日志显示"开始擦除 Flash..."
- [ ] 擦除完成显示"Flash 擦除完成"
- [ ] 成功提示消息显示

#### 6.6 重启设备功能

**测试步骤：**
1. 确保设备已连接
2. 点击"重启设备"按钮

**验证点：**
- [ ] 日志显示"正在重启设备..."
- [ ] 设备重启（LED 闪烁或其他指示）
- [ ] 日志显示"设备已重启"
- [ ] 成功提示消息显示

#### 6.7 断开连接功能

**测试步骤：**
1. 确保设备已连接
2. 点击"断开连接"按钮

**验证点：**
- [ ] 连接断开
- [ ] 状态卡片更新为"未连接设备"
- [ ] 状态指示灯变为红色
- [ ] 日志显示"已断开连接"
- [ ] 按钮状态正确更新

#### 6.8 日志功能

**测试步骤：**
1. 执行各种操作
2. 观察日志面板
3. 点击"清空日志"按钮

**验证点：**
- [ ] 每个操作都有日志记录
- [ ] 日志包含时间戳
- [ ] 不同类型日志颜色不同（成功/错误/警告）
- [ ] 日志自动滚动到底部
- [ ] 清空日志功能正常

### 7. 错误处理测试

#### 7.1 未连接设备时操作
- [ ] 点击"开始烧录"显示错误提示
- [ ] 点击"擦除Flash"显示错误提示
- [ ] 点击"重启设备"显示错误提示

#### 7.2 未选择固件时烧录
- [ ] 点击"开始烧录"显示错误提示

#### 7.3 烧录过程中断
- [ ] 烧录中拔掉设备，显示错误信息
- [ ] 错误日志正确记录

#### 7.4 固件文件不存在
- [ ] 修改固件路径为不存在的文件
- [ ] 尝试烧录，显示"下载固件失败"错误

### 8. 性能测试

#### 8.1 页面加载
- [ ] 页面加载时间 < 2 秒
- [ ] 无明显卡顿

#### 8.2 固件下载
- [ ] 6MB 固件下载时间合理
- [ ] 下载过程无阻塞

#### 8.3 烧录性能
- [ ] 烧录进度更新流畅
- [ ] 日志输出不影响性能

### 9. 响应式测试

- [ ] 在 1920x1080 分辨率下显示正常
- [ ] 在 1366x768 分辨率下显示正常
- [ ] 在 1280x720 分辨率下显示正常
- [ ] 卡片和按钮布局合理

### 10. 兼容性测试

#### 10.1 浏览器测试
- [ ] Chrome 最新版 - 完全支持 ✅
- [ ] Edge 最新版 - 完全支持 ✅
- [ ] Firefox - 显示不支持提示 ⚠️
- [ ] Safari - 显示不支持提示 ⚠️

#### 10.2 操作系统测试
- [ ] Windows 10/11
- [ ] macOS
- [ ] Linux

#### 10.3 设备测试
- [ ] ESP32-S3 设备
- [ ] ESP32-C3 设备（如有）
- [ ] 其他 ESP32 系列设备

### 11. 文档测试

- [ ] 快速开始文档准确
- [ ] 功能说明文档完整
- [ ] 安装指南可操作
- [ ] 代码注释清晰

### 12. 生产环境测试

```bash
npm run build
```

**验证点：**
- [ ] 构建成功
- [ ] dist 目录生成
- [ ] 固件文件正确复制到 dist/firmware/
- [ ] 生产环境页面正常运行

## 🐛 已知问题

记录测试中发现的问题：

| 问题描述 | 严重程度 | 状态 |
|---------|---------|------|
| （示例）烧录进度偶尔不更新 | 低 | 待修复 |

## ✅ 测试结论

- [ ] 所有核心功能正常
- [ ] UI 显示正确
- [ ] 错误处理完善
- [ ] 文档齐全
- [ ] 可以发布使用

## 📝 测试签名

- **测试人员**: ___________
- **测试日期**: ___________
- **测试环境**: ___________
- **测试结果**: □ 通过  □ 不通过

## 💡 改进建议

记录测试过程中的改进建议：

1. 
2. 
3. 

---

**注意**: 请在测试时逐项勾选，确保所有功能都经过验证。

