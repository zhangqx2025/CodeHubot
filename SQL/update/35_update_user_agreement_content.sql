-- ==========================================================================================================
-- 更新用户协议内容脚本
-- ==========================================================================================================
-- 脚本名称: 35_update_user_agreement_content.sql
-- 脚本版本: 1.0.0
-- 创建日期: 2025-12-20
-- 兼容版本: MySQL 5.7.x, 8.0.x
-- 字符集: utf8mb4
-- 排序规则: utf8mb4_unicode_ci
--
-- ==========================================================================================================
-- 脚本说明
-- ==========================================================================================================
--
-- 1. 用途说明:
--    更新系统配置表中的用户协议内容，包含北京幂策科技有限公司的完整用户协议
--
-- 2. 功能特性:
--    - 可重复执行（使用 UPDATE 语句）
--    - 不依赖存储过程
--    - 兼容 MySQL 5.7/8.0
--    - 内容支持 HTML 格式，便于前端显示
--
-- 3. 执行方式:
--    mysql -h hostname -u username -p --default-character-set=utf8mb4 aiot_admin < 35_update_user_agreement_content.sql
--
-- 4. 注意事项:
--    - 本脚本会覆盖现有的用户协议内容
--    - 执行前请确认 core_system_config 表已存在
--    - 如果 user_agreement 配置项不存在，会自动创建
--
-- ==========================================================================================================

-- 设置字符集
SET NAMES utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 显示当前数据库
SELECT '========================================' AS '';
SELECT CONCAT('当前数据库: ', DATABASE()) AS '';
SELECT '开始更新用户协议内容...' AS '';
SELECT '========================================' AS '';

-- ==========================================================================================================
-- 第一步：确保配置项存在
-- ==========================================================================================================

-- 如果配置项不存在，先创建
INSERT IGNORE INTO `core_system_config` (
    `config_key`,
    `config_value`,
    `config_type`,
    `description`,
    `category`,
    `is_public`
) VALUES (
    'user_agreement',
    '',
    'text',
    '用户协议内容',
    'policy',
    1
);

SELECT '✓ 用户协议配置项已确保存在' AS '';

-- ==========================================================================================================
-- 第二步：更新用户协议内容
-- ==========================================================================================================

UPDATE `core_system_config`
SET `config_value` = '
<h1>用户协议</h1>

<h2>一、说明</h2>
<p>本用户协议双方为 <strong>北京幂策科技有限公司</strong>（下称"平台方"）与平台（网址：下称"本平台"）网络用户，本用户协议具有合同效力。</p>

<p>本用户协议内容包括协议正文及所有本平台已经发布的或将来可能发布的各类规则。所有规则为协议不可分割的一部分，与协议正文具有同等法律效力。</p>

<p>在本用户协议中没有以"规则"字样表示的链接文字所指示的文件不属于本用户协议的组成部分，而是其他内容的协议或有关参考数据，与本协议没有法律上的直接关系。</p>

<p>用户在使用本平台提供的各项服务的同时，承诺接受并遵守各项相关规则的规定。平台方有权根据需要不时地制定、修改本协议或各类规则，如本协议有任何变更，平台方将在网站上刊载公告，通知予用户。如用户不同意相关变更，必须停止使用"服务"。经修订的协议一经在本平台公布后，立即自动生效。各类规则会在发布后生效,亦成为本协议的一部分。登录或继续使用"服务"将表示用户接受经修订的协议。除另行明确声明外，任何使"服务"范围扩大或功能增强的新内容均受本协议约束。</p>

<p>用户确认本用户协议后，本用户协议即在用户和平台方之间产生法律效力。请用户务必在注册之前认真阅读全部用户协议内容，如有任何疑问，可向本平台咨询。</p>

<ol>
  <li>无论用户事实上是否在注册之前认真阅读了本用户协议，只要用户点击协议正本下方的"确认"按钮并按照本平台注册程序成功注册为用户，用户的行为仍然表示其同意并签署了本用户协议。</li>
  <li>本协议不涉及用户与本平台其他用户之间因项目使用而产生的法律关系及法律纠纷。</li>
</ol>

<h2>二、定义</h2>

<h3>1. 使用平台</h3>
<p>指由平台方运营的，为用户提供项目使用、技能训练、进度跟踪、知识库访问等服务的网络教育平台，平台上的术语或图示的含义，详见本平台帮助中心。</p>

<h3>2. 用户及用户注册</h3>
<p>用户必须是具备完全民事行为能力的自然人。无民事行为能力人、限制民事行为能力人不应注册为本平台用户，其与平台方之间的用户协议自始无效，平台方一经发现，有权立即注销该用户，并追究其使用本平台"服务"的一切法律责任。</p>

<p>用户注册是指用户登录本平台，并按要求填写相关信息并确认同意履行相关用户协议的过程。用户因使用本平台服务、获取有偿在线项目或接触本平台服务器而发生的所有应纳税赋，以及一切硬件、软件、服务及其他方面的费用均由用户负责支付。本平台仅作为跨学科项目式使用服务提供平台。</p>

<h2>三、用户权利和义务</h2>

<h3>所有用户必须遵循：</h3>
<ol>
  <li>遵守所有使用网络服务的网络协议、规定、程序和惯例；</li>
  <li>不得使用本平台从事违法活动；</li>
  <li>不得干扰或侵犯本平台的正常运行和其他用户的正常使用；</li>
  <li>未经允许，不得以任何形式下载或试图下载本平台的任何项目内容、知识库资料、项目设计方案等受知识产权保护的内容；</li>
  <li>用户购买的在线项目仅允许个人使用，不得用于商业传播、转售、共享等其他目的；</li>
  <li>从中国境内向境外传输技术性资料时不得违反中国有关法律法规。</li>
</ol>

<h3>同时用户承诺：</h3>
<ol>
  <li><strong>不得利用本平台制作、复制、查阅和传播下列信息：</strong>
    <ul>
      <li>任何非法的、骚扰性的、中伤他人的、辱骂性的、恐吓性的、伤害性的、庸俗的、淫秽的信息资料；</li>
      <li>任何教唆他人进行违法犯罪行为的资料；</li>
      <li>不利于国内团结和社会安定的资料；</li>
      <li>任何不符合国家法律法规规定的资料、信息；</li>
      <li>任何捏造或者歪曲事实，散布谣言，扰乱社会秩序的信息；</li>
      <li>损害平台方及本平台声誉和商业利益的信息；</li>
    </ul>
  </li>
  <li>不得未经许可而非法进入其他个人或组织电脑系统；</li>
  <li>未经允许，不得对本平台中存储、处理或者传输的数据和应用程序进行删除、修改或者增加；</li>
  <li>不得故意制作、传播计算机病毒等破坏性程序；</li>
  <li>法律规定的其他义务。</li>
</ol>

<p><strong>如果用户的行为违背上述两款规定，平台方可以做出独立判断并有权立即取消用户资格。用户应对自己在本平台上的违法行为承担全部法律责任。</strong></p>

<h3>基于网络服务的特殊性，用户同意：</h3>
<ol>
  <li>在注册时按照注册提示提供准确用户名和密码以及详尽的个人资料；</li>
  <li>在个人的注册信息发生变化时，用户应及时更新自己的注册信息，保证其个人资料的详尽和准确。所有用户输入的个人信息将被视作准确表明了用户的身份，并作为平台方提供所有服务的有效身份依据。</li>
  <li>用户自行配备上网的所需设备，包括个人电脑、调制解调器或其他必备上网装置；</li>
  <li>用户应自行负担因使用这种接入方式而产生的上网电话费、上网信息费及项目使用相关费用。</li>
</ol>

<h3>用户的用户名、密码：</h3>
<ol>
  <li>用户一旦注册成功，成为本平台正式用户后，应当对自己的用户名（亦称账号）、密码的安全性负全部责任。用户的密码只能由用户自己掌握。</li>
  <li>对于用户因账号或密码泄露造成的各种损失，平台方不承担任何责任。用户发现任何非法使用用户账号的情况，应立即通知平台方。</li>
  <li>用户应对以其用户名进行的所有活动和事件负责。</li>
  <li>一个用户账号只能由一个用户使用，不允许多个用户使用同一个帐号，如果用户违反此规定，平台方将有权将此账号作为无效处理并保留追究法律责任的权利。</li>
  <li>用户应使用正版在线项目及相关服务，对于涉嫌盗版、共享的违规账号，一经证实，平台方将有权将此账号做封号处理并保留追究法律责任的权利。</li>
</ol>

<h2>四、关于平台服务的说明</h2>

<ol>
  <li><strong>所有在线项目一经购买</strong>（包括网上支付、线下转账等各种购买方式），<strong>除在线项目存在明确质量问题外，不允许任何形式的退换。</strong></li>
  
  <li>在线项目的购买费用仅为项目本身的服务费用，不包含上网电话费、上网信息费、个人设备购置及使用等相关费用。</li>
  
  <li>用户通过购买在线项目获得使用权限后，应在本平台规定的项目有效期内完成使用（具体有效期以各项目页面标注为准，如"8周""4周"等）。</li>
  
  <li>用户购买的在线项目，在有效期内可享受重复使用权限，可查看使用进度、任务完成情况、知识点掌握度等相关使用数据。</li>
  
  <li><strong>用户购买系列在线项目的，另需遵守以下规则：</strong>
    <ul>
      <li>只能使用该系列项目范围内的项目内容，系列范围之外的在线项目，用户无权使用；</li>
      <li>自购买之日起30天内，系列项目未使用或仅产生4次以内有效使用记录的，用户可申请更换本平台内同等级别的其他系列在线项目；</li>
    </ul>
  </li>
  
  <li><strong>赠送类在线项目</strong>（非经购买而是通过平台活动、福利等方式获得）与付费在线项目相比有其特定规则，用户应遵守以下规则：
    <ul>
      <li>赠送类在线项目的使用范围已预先设定，用户应在此范围内使用且不可变更；</li>
      <li>用户应在赠送项目规定的截止日期前登录平台开始使用，并在标注的有效期内完成使用；</li>
      <li>赠送类在线项目不可续费，有效期届满后自动终止服务；</li>
      <li>赠送类在线项目不能进行任何形式的退费，也不允许将相关使用权限转让或转至其他类型项目。</li>
    </ul>
  </li>
</ol>

<h2>五、平台方的权利和义务</h2>

<ol>
  <li>平台方有义务在现有技术上维护整个跨学科项目式使用平台的正常运行，并努力提升和改进技术，使用户的项目使用活动得以顺利进行；</li>
  
  <li>对用户在注册使用本平台中所遇到的与项目使用、账号注册相关的问题及反映的情况，平台方应及时作出回复；</li>
  
  <li>对于用户在本平台上的不当行为或其他任何平台方认为应当终止服务的情况，平台方有权随时作出删除相关信息、终止服务提供等处理，而无须征得用户的同意；平台方应本着诚实信用的原则向用户提供项目式使用服务，不得随意中断或停止提供该项服务。但由于不可抗力或者其他非人为因素造成的服务中断或停止，平台方不承担任何相应的责任。</li>
  
  <li>本平台内以任何形式表现的作品（包括但不限于在线项目内容、知识库资料、技能指导文档、图片、视频、音频、表格等）的著作权，由作品的著作权人和平台方共同享有，用户未经许可，不得擅自对本平台的任何作品进行任何形式的翻录、复制、传播或从事其他任何违反著作权法等相关法律法规的活动。对侵犯本平台知识产权的个人和组织，平台方和作品的著作权人将依法追究其民事或刑事责任。</li>
  
  <li>平台方享有对用户网上活动的监督和指导权，对凡是从事网上非法活动的用户，有权终止所有服务。</li>
  
  <li><strong>许可使用权：</strong>平台方对用户在网上发表的供使用交流的作品（包括但不限于使用成果、项目作品、交流言论等），享有独家的出版、发行和复制的权利。用户以此授予平台方及其关联公司独家的、全球通用的、永久的、免费的许可使用权利（并有权在多个层面对该权利进行再授权），使平台方及其关联公司有权（全部或部分）使用、复制、修订、改写、发布、翻译、分发、执行和展示用户的全部资料和数据（包括但不限于注册资料、使用行为数据及全部展示于平台的各类信息）或制作其派生作品，和/或以现在已知或日后开发的任何形式、媒体或技术，将上述信息纳入其他作品内。</li>
</ol>

<h2>六、用户协议的修改和完善</h2>

<ol>
  <li>平台方将根据互联网的发展和法律法规的变化，在认为必要时可以单方面修改用户协议。</li>
  
  <li>本用户协议一旦发生变动，将会在重要页面上提示修改内容。如果不同意所改动的内容，用户可以主动放弃获得的网络服务。如果用户继续享用网络服务，则视为接受用户协议的变动。当发生争议时，应以最新用户协议的内容为准。</li>
  
  <li>平台方有权根据实际情况，调整在线项目的指导教师、项目内容细节或使用安排，该等调整如与宣传材料不符，以平台实际公布的内容为准。平台方将最大限度地保护用户的使用质量。</li>
</ol>

<h2>七、服务的中断和终止</h2>

<p>用户同意，在平台方未向用户收取服务费的情况下，平台方可自行全权决定以任何理由（包括但不限于平台方认为用户已违反本协议的字面意义和精神，或以不符合本协议的字面意义和精神的方式行事，或用户在超过90天的时间内未以用户的账号及密码登录平台等）终止用户的"服务"密码、账户（或其任何部分）或用户对"服务"的使用，并删除（不再保存）用户在使用"服务"中提交的任何资料。同时平台方可自行全权决定，在发出通知或不发出通知的情况下，随时停止提供"服务"或其任何部分。账号终止后，平台方没有义务为用户保留原账号中或与之相关的任何信息，或转发任何未曾阅读或发送的信息给用户或第三方。</p>

<p>此外，用户同意，平台方不就终止用户接入"服务"而对用户或任何第三者承担任何责任。</p>

<h3>如用户向平台方提出注销本平台注册用户身份时，经平台方审核同意，由平台方注销该注册用户，用户即解除与平台方的用户协议关系。但注销该用户账号后，平台方仍保留下列权利：</h3>
<ol>
  <li>用户注销后，平台方有权保留该用户的注册数据及以前的行为记录；</li>
  <li>用户注销后，如用户在注销前在本平台上存在违法行为或违反合同的行为，平台方仍可行使本用户协议所规定的权利。</li>
</ol>

<h3>在下列情况下，平台方可通过注销用户的方式终止服务：</h3>
<ol>
  <li>在用户违反本用户协议相关规定时，平台方有权终止向该用户提供服务。平台方将在中断服务时通知用户。但如该用户在被平台方终止提供服务后，再一次直接或间接或以他人名义注册为本平台用户的，平台方有权再次单方面终止向该用户提供服务；</li>
  
  <li>如平台方通过用户提供的信息与用户联系时，发现用户在注册时填写的电子邮箱已不存在或无法接收电子邮件的，经平台方以其他联系方式通知用户更改，而用户仍未能提供新的电子邮箱地址的，平台方有权终止向该用户提供服务；</li>
  
  <li>一旦平台方发现用户注册数据中主要内容是虚假的，平台方有权随时终止向该用户提供服务；</li>
  
  <li>用户协议终止或更新时，用户明示不愿接受新的用户协议的；</li>
  
  <li>其他平台方认为需终止服务的情况。</li>
</ol>

<h2>八、责任范围</h2>

<p>用户明确理解和同意，平台方不对因下述任一情况而导致的任何损害赔偿承担责任，包括但不限于利润、商誉、使用、数据等方面的损失或其他无形损失的损害赔偿（无论平台方是否已被告知该等损害赔偿的可能性）：</p>
<ol>
  <li>使用或未能使用"服务"；</li>
  <li>第三方未经批准的接入或第三方更改用户的传输数据或数据；</li>
  <li>第三方对"服务"的声明或关于"服务"的行为；或非因平台方的原因而引起的与"服务"有关的任何其他事宜，包括疏忽；</li>
</ol>

<p>用户明确理解并同意，如因其违反有关法律或者本协议之规定，使平台方遭受任何损失，受到任何第三方的索赔，或任何行政管理部门的处罚，用户应对平台方提供补偿，包括合理的律师费用等。</p>

<h3>担保责任：</h3>
<p>平台方不担保其服务一定能够满足用户的要求，也不担保其服务不会因各种客观原因中断。平台方拒绝提供担保，由用户自己承担系统受损或资料丢失的风险和责任。</p>

<h2>九、隐私权政策</h2>

<h3>适用范围：</h3>
<ol>
  <li>用户注册本平台账户时，用户根据本平台要求提供的个人注册信息；</li>
  
  <li>在用户使用本平台服务，参加本平台活动，或访问本平台网页时，本平台自动接收并记录用户浏览器上的服务器数值，包括但不限于IP地址等数据及用户要求取用的网页记录；</li>
  
  <li>本平台收集到的用户在使用本平台的有关数据，包括但不限于项目购买记录、使用进度数据、任务完成情况、技能掌握度、使用时长等行为数据；</li>
  
  <li>本平台通过合法途径从商业伙伴处取得的用户个人数据。</li>
</ol>

<h3>信息使用：</h3>
<ol>
  <li>本平台不会向任何人出售或出借用户的个人信息，除非事先得到用户的许可；</li>
  
  <li>本平台亦不允许任何第三方以任何手段收集、编辑、出售或者无偿传播用户的个人信息。任何用户如从事上述活动，一经发现，本平台有权立即终止与该用户的用户协议，查封其账号；</li>
  
  <li>为服务用户的目的，本平台可能通过使用用户的个人信息，向用户提供服务，包括但不限于向用户发出项目推荐、使用提醒、服务更新等信息。</li>
</ol>

<h3>信息披露：</h3>
<p>用户的个人信息将在下述情况下部分或全部被披露：</p>
<ol>
  <li>经用户同意，向第三方披露；</li>
  
  <li>如用户是符合资格的知识产权投诉人并已提起投诉，应被投诉人要求，向被投诉人披露，以便双方处理可能的权利纠纷；</li>
  
  <li>根据法律的有关规定，或者行政或司法机构的要求，向第三方或者行政、司法机构披露；</li>
  
  <li>如果用户出现违反中国有关法律或者平台政策的情况，需要向第三方披露；</li>
  
  <li>为提供用户所要求的产品和服务，而必须和第三方分享用户的个人信息；</li>
  
  <li>其他本平台根据法律或者平台政策认为合适的披露。</li>
</ol>

<h3>信息安全：</h3>
<ol>
  <li>本平台账户有安全保护功能，请妥善保管用户的账户及密码信息；</li>
  
  <li>如果用户发现自己的个人信息泄密，尤其是本平台账户及密码发生泄露，请用户立即联络本平台客服，以便本平台采取相应措施。</li>
</ol>

<h2>十、法律与管辖</h2>

<p>本用户协议根据现行中华人民共和国法律法规制定。如发生协议条款与中华人民共和国法律法规相抵触时，则这些条款将完全按法律法规的规定重新解释，本用户协议的其他条款仍对平台方和用户具有法律约束力。</p>

<p><strong>因本用户协议而发生的任何争议应向本协议签署地北京市海淀区所在地有管辖权的人民法院提起诉讼。</strong></p>
',
    `updated_at` = CURRENT_TIMESTAMP
WHERE `config_key` = 'user_agreement';

SELECT '✓ 用户协议内容已成功更新' AS '';

-- ==========================================================================================================
-- 第三步：验证更新结果
-- ==========================================================================================================

SELECT '========================================' AS '';
SELECT '用户协议更新完成！以下是更新后的信息：' AS '';
SELECT '========================================' AS '';

SELECT 
    `config_key` AS '配置键',
    LENGTH(`config_value`) AS '内容长度(字节)',
    CHAR_LENGTH(`config_value`) AS '内容长度(字符)',
    `description` AS '描述',
    `category` AS '分类',
    `is_public` AS '是否公开',
    `updated_at` AS '更新时间'
FROM `core_system_config`
WHERE `config_key` = 'user_agreement';

-- ==========================================================================================================
-- 脚本执行完成
-- ==========================================================================================================
-- 
-- 说明：
-- 1. 本脚本已成功更新用户协议内容
-- 2. 协议内容使用 HTML 格式，便于前端渲染展示
-- 3. 内容包含完整的北京幂策科技有限公司用户协议
-- 4. 协议包含以下章节：
--    - 说明
--    - 定义
--    - 用户权利和义务
--    - 关于平台服务的说明
--    - 平台方的权利和义务
--    - 用户协议的修改和完善
--    - 服务的中断和终止
--    - 责任范围
--    - 隐私权政策
--    - 法律与管辖
-- 
-- 5. 前端展示建议：
--    - 使用 v-html 指令渲染 HTML 内容
--    - 添加适当的样式美化显示效果
--    - 在用户注册时显示并要求用户同意
--    - 在设置页面提供查看入口
-- 
-- ==========================================================================================================
