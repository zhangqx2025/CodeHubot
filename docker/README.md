# Docker éƒ¨ç½²è¯´æ˜

æœ¬ç›®å½•åŒ…å« CodeHubot ç³»ç»Ÿçš„ Docker å®¹å™¨åŒ–éƒ¨ç½²é…ç½®ã€‚

## ğŸ“ æ–‡ä»¶è¯´æ˜

- `docker-compose.yml` - å¼€å‘ç¯å¢ƒé…ç½®ï¼ˆä»…åŒ…å«åŸºç¡€æœåŠ¡ï¼šMySQLã€Redisã€MQTTï¼‰
- `docker-compose.prod.yml` - ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆåŒ…å«æ‰€æœ‰æœåŠ¡ï¼‰
- `.env.example` - ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹
- `mosquitto.conf` - MQTT æœåŠ¡é…ç½®

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶
vim .env
```

### 2. ä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# ä»é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
cd ..
./deploy.sh deploy
```

### 3. æ‰‹åŠ¨éƒ¨ç½²

```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.prod.yml up -d --build

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.prod.yml ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f
```

## ğŸ“š è¯¦ç»†æ–‡æ¡£

è¯·å‚è€ƒ [Docker éƒ¨ç½²æ–‡æ¡£](../deploy/docs/docker-deployment.md) è·å–å®Œæ•´çš„éƒ¨ç½²æŒ‡å—ã€‚

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.prod.yml up -d

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.prod.yml down

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose -f docker-compose.prod.yml restart [æœåŠ¡å]

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f [æœåŠ¡å]

# è¿›å…¥å®¹å™¨
docker-compose -f docker-compose.prod.yml exec [æœåŠ¡å] sh

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.prod.yml ps
```

## ğŸ—ï¸ æœåŠ¡æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend   â”‚ (Nginx + Vue.js)
â”‚   Port: 80  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend   â”‚  â”‚ Config Service â”‚
â”‚ Port: 8000  â”‚  â”‚  Port: 8001    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚          â”‚          â”‚          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚  MySQL   â”‚ â”‚ Redis  â”‚ â”‚  MQTT  â”‚ â”‚  ...   â”‚
â”‚ Port:3306â”‚ â”‚Port:6379â”‚ â”‚Port:1883â”‚ â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡éƒ¨ç½²**ï¼šç¡®ä¿å·²é…ç½® `.env` æ–‡ä»¶ï¼Œç‰¹åˆ«æ˜¯ `SECRET_KEY` å’Œ `INTERNAL_API_KEY`
2. **æ•°æ®æŒä¹…åŒ–**ï¼šæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨ Docker æ•°æ®å·ä¸­ï¼Œåˆ é™¤å®¹å™¨ä¸ä¼šåˆ é™¤æ•°æ®
3. **ç«¯å£å†²çª**ï¼šç¡®ä¿æ‰€éœ€ç«¯å£æœªè¢«å ç”¨
4. **èµ„æºè¦æ±‚**ï¼šå»ºè®®è‡³å°‘ 4GB RAM å’Œ 20GB ç£ç›˜ç©ºé—´

## ğŸ” æ•…éšœæ’æŸ¥

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœåŠ¡æ—¥å¿—ï¼š`docker-compose -f docker-compose.prod.yml logs [æœåŠ¡å]`
2. æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š`docker-compose -f docker-compose.prod.yml ps`
3. å‚è€ƒ [éƒ¨ç½²æ–‡æ¡£](../deploy/docs/docker-deployment.md) çš„æ•…éšœæ’æŸ¥éƒ¨åˆ†
